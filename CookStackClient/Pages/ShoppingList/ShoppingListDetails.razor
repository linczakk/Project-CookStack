@using CookStackClient.Services
@using CookStackShared.ShoppingList.Dtos

@page "/shopping-list/{id:int}"
@inject ShoppingListApiClient ShoppingListApi

<PageTitle>Shopping List</PageTitle>

@if (IsOpen)
{
	<div class="modal-backdrop fade show"></div>

	<div class="modal fade show d-block" tabindex="-1" @onclick="Close">
		<div class="modal-dialog" @onclick:stopPropagation="true">
			<div class="modal-content">
				<div class="modal-body">
					@if (shoppingListDto != null)
					{
						<h2><b>@shoppingListDto.Title</b></h2>

						<hr />
						<p>@shoppingListDto.Description</p>

						@if (shoppingListDto.Description.Any())
						{
							<hr />
						}

						<table class="table table-sm">
							@foreach (var item in shoppingListDto.Items)
							{
								<tr>
									<td><input type="checkbox" /></td>
									<td>@item.Name</td>
									<td>@item.Quantity @item.Unit</td>
								</tr>
							}
						</table>
					}
					else
					{
						<p>Loading...</p>
					}
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary mb-2" @onclick="Close">Close</button>
				</div>
			</div>
		</div>
	</div>
}


@code {
	private int Id { get; set; }
	private ShoppingListDetailsDto? shoppingListDto;

	private bool IsOpen;

	public async Task Show(int id)
	{
		Id = id;
		IsOpen = true;
		Console.WriteLine(Id);

		shoppingListDto = await ShoppingListApi.GetShoppingListByIdAsync(Id);
		StateHasChanged();
	}
	public void Close() => IsOpen = false;
}
